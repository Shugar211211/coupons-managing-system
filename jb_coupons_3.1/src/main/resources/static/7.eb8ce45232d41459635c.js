(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{d7gL:function(t,e,n){"use strict";n.r(e),n.d(e,"CustomerModule",function(){return Z});var o=n("N2Tv"),c=n("fXoL"),i=n("IYfF"),r=n("tyNb");let s=(()=>{class t{constructor(t,e){this.authService=t,this.router=e}canActivate(t,e){if(this.authService.getClientRole()==o.a.CUSTOMER)return!0;this.authService.logout(),this.router.navigate(["/"],{queryParams:{authStatus:!1},queryParamsHandling:"merge",skipLocationChange:!0})}}return t.\u0275fac=function(e){return new(e||t)(c.Ob(i.a),c.Ob(r.c))},t.\u0275prov=c.Db({token:t,factory:t.\u0275fac}),t})();var a=n("PCNd"),b=n("ofXK"),u=n("FYjP");const l=function(){return["/customer","home"]},g=function(){return["/customer","coupons"]},p=function(){return["/customer","purchase"]};let h=(()=>{class t{constructor(t,e){this.router=t,this.autheService=e}ngOnInit(){this.name=sessionStorage.getItem("name")}logout(t){t.preventDefault(),this.autheService.logout(),this.router.navigate(["/"])}}return t.\u0275fac=function(e){return new(e||t)(c.Hb(r.c),c.Hb(i.a))},t.\u0275cmp=c.Bb({type:t,selectors:[["app-customer-layout"]],decls:19,vars:7,consts:[[1,"navbar","bg-primary"],["routerLinkActive","active"],[3,"routerLink"],["href","#",3,"click"],[1,"container"]],template:function(t,e){1&t&&(c.Kb(0,"nav",0),c.Kb(1,"h1"),c.jc(2),c.Jb(),c.Kb(3,"ul"),c.Kb(4,"li",1),c.Kb(5,"a",2),c.jc(6,"Home"),c.Jb(),c.Jb(),c.Kb(7,"li",1),c.Kb(8,"a",2),c.jc(9,"My coupons"),c.Jb(),c.Jb(),c.Kb(10,"li",1),c.Kb(11,"a",2),c.jc(12,"Purchase new coupon"),c.Jb(),c.Jb(),c.Kb(13,"li"),c.Kb(14,"a",3),c.Rb("click",function(t){return e.logout(t)}),c.jc(15,"Logout"),c.Jb(),c.Jb(),c.Jb(),c.Jb(),c.Kb(16,"div",4),c.Ib(17,"app-alert"),c.Ib(18,"router-outlet"),c.Jb()),2&t&&(c.xb(2),c.lc("Welcome ",e.name,""),c.xb(3),c.Xb("routerLink",c.Zb(4,l)),c.xb(3),c.Xb("routerLink",c.Zb(5,g)),c.xb(3),c.Xb("routerLink",c.Zb(6,p)))},directives:[r.d,r.e,u.a,r.g],styles:[".container[_ngcontent-%COMP%]{max-width:900px}"]}),t})();var d=n("uQub"),m=n("Cmua"),f=n("3Pt+"),x=n("cHH+"),C=n("CtUz");function v(t,e){if(1&t&&(c.Kb(0,"option",11),c.jc(1),c.Ub(2,"lowercase"),c.Jb()),2&t){const t=e.$implicit;c.Xb("ngValue",t),c.xb(1),c.kc(c.Vb(2,2,t))}}function J(t,e){if(1&t&&c.Ib(0,"img",17),2&t){const t=c.Tb().$implicit;c.Xb("src",t.image,c.fc)}}const K=function(t){return["/customer/coupons/data",t]};function O(t,e){if(1&t&&(c.Kb(0,"div",12),c.hc(1,J,1,1,"img",13),c.Kb(2,"div",14),c.Kb(3,"h4"),c.jc(4),c.Jb(),c.Jb(),c.Kb(5,"a",15),c.Kb(6,"button",16),c.jc(7,"Details"),c.Jb(),c.Jb(),c.Jb()),2&t){const t=e.$implicit;c.xb(1),c.Xb("ngIf",t.image),c.xb(3),c.lc("",t.title," "),c.xb(1),c.Xb("routerLink",c.ac(3,K,t.id))}}function y(t,e){if(1&t){const t=c.Lb();c.Kb(0,"div"),c.Kb(1,"h2"),c.jc(2,"My coupons:"),c.Jb(),c.Kb(3,"div",5),c.jc(4," Filter by maximum price: "),c.Kb(5,"input",6),c.Rb("ngModelChange",function(e){return c.ec(t),c.Tb(2).maxPrice=e}),c.Jb(),c.jc(6," \xa0 Filter by category: "),c.Kb(7,"select",7),c.Rb("ngModelChange",function(e){return c.ec(t),c.Tb(2).selectedCategory=e}),c.Kb(8,"option",8),c.jc(9,"--ALL CATEGORIES--"),c.Jb(),c.hc(10,v,3,4,"option",9),c.Jb(),c.Jb(),c.hc(11,O,8,5,"div",10),c.Ub(12,"filterByMaxprice"),c.Ub(13,"filterByCategory"),c.Jb()}if(2&t){const t=c.Tb(2);c.xb(5),c.Xb("ngModel",t.maxPrice),c.xb(2),c.Xb("ngModel",t.selectedCategory),c.xb(1),c.Xb("ngValue",null),c.xb(2),c.Xb("ngForOf",t.categoriesList),c.xb(1),c.Xb("ngForOf",c.Wb(12,5,c.Wb(13,8,t.coupons,t.selectedCategory),t.maxPrice))}}function M(t,e){if(1&t&&(c.Kb(0,"div",3),c.hc(1,y,14,11,"div",4),c.Jb()),2&t){const t=c.Tb(),e=c.dc(4);c.xb(1),c.Xb("ngIf",t.coupons.length)("ngIfElse",e)}}function P(t,e){1&t&&(c.Kb(0,"p",18),c.jc(1,"Loading coupons..."),c.Jb())}function j(t,e){1&t&&(c.Kb(0,"h3"),c.jc(1,"No purchased coupons"),c.Jb())}let k=(()=>{class t{constructor(t,e){this.couponsService=t,this.alertService=e,this.loading=!1,this.coupons=[],this.maxPrice=0,this.selectedCategory=null,this.categoriesList=[]}ngOnInit(){this.loadCoupons()}ngOnDestroy(){this.cSub&&this.cSub.unsubscribe()}loadCoupons(){this.loading=!0,this.cSub=this.couponsService.getCustomerCoupons().subscribe(t=>{this.coupons=t,this.loading=!1},t=>{this.alertService.danger(t.error.message)}),this.couponsService.getCategoriesForCustomer().subscribe(t=>{this.categoriesObj=t,this.categoriesList=this.categoriesObj.categories},t=>{this.alertService.danger(t.error.message)})}}return t.\u0275fac=function(e){return new(e||t)(c.Hb(d.a),c.Hb(m.a))},t.\u0275cmp=c.Bb({type:t,selectors:[["app-coupons"]],decls:5,vars:2,consts:[["class","container",4,"ngIf","ngIfElse"],["loadingBlock",""],["noElements",""],[1,"container"],[4,"ngIf","ngIfElse"],[1,"filter"],["type","number","min","0","max","99999",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange"],["selected","selected",3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["class","card",4,"ngFor","ngForOf"],[3,"ngValue"],[1,"card"],["alt","coupon image",3,"src",4,"ngIf"],[1,"title"],[3,"routerLink"],[1,"btn","btn-dark"],["alt","coupon image",3,"src"],[1,"text-center"]],template:function(t,e){if(1&t&&(c.hc(0,M,2,2,"div",0),c.hc(1,P,2,0,"ng-template",null,1,c.ic),c.hc(3,j,2,0,"ng-template",null,2,c.ic)),2&t){const t=c.dc(2);c.Xb("ngIf",!e.loading)("ngIfElse",t)}},directives:[b.m,f.k,f.a,f.g,f.i,f.m,f.j,f.o,b.l,r.e],pipes:[x.a,C.a,b.j],styles:["img[_ngcontent-%COMP%]{max-height:100px;max-width:100px;margin-right:20px}.container[_ngcontent-%COMP%]{max-width:700px}.card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{float:right}.card[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{display:inline-block}span[_ngcontent-%COMP%]{font-size:1.4rem}input[_ngcontent-%COMP%]{margin-top:10px}input[type=number][_ngcontent-%COMP%]{width:70px}select[_ngcontent-%COMP%]{width:243px}.filter[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{display:inline-block;margin-top:15px}.title[_ngcontent-%COMP%]{word-wrap:break-word;width:383px}"]}),t})();function S(t,e){if(1&t&&(c.Kb(0,"div"),c.Kb(1,"div",6),c.Ib(2,"img",7),c.Kb(3,"h2"),c.jc(4),c.Jb(),c.Jb(),c.Kb(5,"span"),c.Kb(6,"h3"),c.jc(7),c.Jb(),c.Jb(),c.Kb(8,"span"),c.Kb(9,"h4"),c.jc(10),c.Ub(11,"lowercase"),c.Jb(),c.Jb(),c.Kb(12,"span"),c.Kb(13,"h4"),c.jc(14),c.Jb(),c.Jb(),c.Kb(15,"span"),c.Kb(16,"h4"),c.jc(17),c.Jb(),c.Jb(),c.Kb(18,"span"),c.Kb(19,"h4"),c.jc(20),c.Ub(21,"date"),c.Jb(),c.Jb(),c.Kb(22,"span"),c.Kb(23,"h4"),c.jc(24),c.Ub(25,"date"),c.Jb(),c.Jb(),c.Jb()),2&t){const t=c.Tb();c.xb(2),c.Xb("src",t.coupon.image,c.fc),c.xb(2),c.kc(t.coupon.title),c.xb(3),c.kc(t.coupon.description),c.xb(3),c.lc("Category: ",c.Vb(11,8,t.coupon.category),""),c.xb(4),c.lc("Quantity: ",t.coupon.amount," items"),c.xb(3),c.lc("Price: ",t.coupon.price," NIS"),c.xb(3),c.lc("Issue date: ",c.Vb(21,10,t.coupon.startDate),""),c.xb(4),c.lc("Expiration date: ",c.Vb(25,12,t.coupon.endDate),"")}}function w(t,e){1&t&&(c.Kb(0,"p",8),c.jc(1,"Loading..."),c.Jb())}const I=function(){return["/customer/coupons"]};let L=(()=>{class t{constructor(t,e,n,o){this.couponsService=t,this.router=e,this.route=n,this.alertService=o,this.loading=!1}ngOnInit(){this.loadCoupon()}ngOnDestroy(){this.dSub&&this.dSub.unsubscribe()}deleteCouponPurchase(){this.dSub=this.couponsService.deleteCouponPurchase(this.coupon).subscribe(()=>{this.alertService.success("Coupon purchase deleted"),this.router.navigate(["/customer/coupons"])},t=>{this.alertService.danger(t.error.message)})}loadCoupon(){this.loading=!0,this.route.params.subscribe(t=>{this.couponsService.getCustomerCouponById(t.id).subscribe(t=>{this.coupon=t,null!=this.coupon&&(this.loading=!1)},t=>{this.alertService.danger(t.error.message)})})}}return t.\u0275fac=function(e){return new(e||t)(c.Hb(d.a),c.Hb(r.c),c.Hb(r.a),c.Hb(m.a))},t.\u0275cmp=c.Bb({type:t,selectors:[["app-coupon-details"]],decls:9,vars:4,consts:[[3,"routerLink"],[1,"btn","btn-dark"],[1,"btn","btn-dark",3,"click"],[1,"card"],[4,"ngIf","ngIfElse"],["loadingBlock",""],[1,"card","header"],[3,"src"],[1,"text-center"]],template:function(t,e){if(1&t&&(c.Kb(0,"a",0),c.Kb(1,"button",1),c.jc(2,"Back"),c.Jb(),c.Jb(),c.Kb(3,"button",2),c.Rb("click",function(){return e.deleteCouponPurchase()}),c.jc(4,"Delete this purchase"),c.Jb(),c.Kb(5,"div",3),c.hc(6,S,26,14,"div",4),c.Jb(),c.hc(7,w,2,0,"ng-template",null,5,c.ic)),2&t){const t=c.dc(8);c.Xb("routerLink",c.Zb(3,I)),c.xb(6),c.Xb("ngIf",!e.loading)("ngIfElse",t)}},directives:[r.e,b.m],pipes:[b.j,b.e],styles:["img[_ngcontent-%COMP%]{max-height:100px;max-width:100px;margin-right:20px}span[_ngcontent-%COMP%]{margin:5px}button[_ngcontent-%COMP%], label[_ngcontent-%COMP%]{margin-top:10px}label[_ngcontent-%COMP%]{color:#000;font-family:Roboto,sans-serif;font-size:1.2rem;font-weight:700;line-height:1.6;background-color:#fff;color:#333}input[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:10px}"]}),t})();function _(t,e){if(1&t&&(c.Kb(0,"option",11),c.jc(1),c.Ub(2,"lowercase"),c.Jb()),2&t){const t=e.$implicit;c.Xb("ngValue",t),c.xb(1),c.kc(c.Vb(2,2,t))}}function X(t,e){if(1&t&&c.Ib(0,"img",17),2&t){const t=c.Tb().$implicit;c.Xb("src",t.image,c.fc)}}function F(t,e){if(1&t){const t=c.Lb();c.Kb(0,"div",12),c.hc(1,X,1,1,"img",13),c.Kb(2,"div",14),c.Kb(3,"span",15),c.Kb(4,"h3"),c.jc(5),c.Jb(),c.Jb(),c.Kb(6,"h3"),c.jc(7),c.Jb(),c.Kb(8,"h5"),c.jc(9),c.Ub(10,"lowercase"),c.Jb(),c.Kb(11,"h5"),c.jc(12),c.Ub(13,"date"),c.Jb(),c.Kb(14,"h5"),c.jc(15),c.Ub(16,"date"),c.Jb(),c.Kb(17,"h5"),c.jc(18),c.Jb(),c.Jb(),c.Kb(19,"h3"),c.jc(20),c.Jb(),c.Kb(21,"button",16),c.Rb("click",function(){c.ec(t);const n=e.$implicit;return c.Tb(3).purchase(n)}),c.jc(22,"Purchase"),c.Jb(),c.Jb()}if(2&t){const t=e.$implicit,n=c.Tb(3);c.xb(1),c.Xb("ngIf",t.image),c.xb(4),c.kc(t.title),c.xb(2),c.lc("Price: ",t.price,""),c.xb(2),c.lc("Category: ",c.Vb(10,9,t.category),""),c.xb(3),c.lc("Launch date: ",c.Vb(13,11,t.startDate),""),c.xb(3),c.lc("Expiration date: ",c.Vb(16,13,t.startDate),""),c.xb(3),c.lc("",t.description," "),c.xb(2),c.lc("",t.Description," "),c.xb(1),c.Xb("disabled",n.purchasing)}}function E(t,e){if(1&t){const t=c.Lb();c.Kb(0,"div"),c.Kb(1,"h2"),c.jc(2,"Awailable coupons:"),c.Jb(),c.Kb(3,"div",5),c.jc(4," Filter by maximum price: "),c.Kb(5,"input",6),c.Rb("ngModelChange",function(e){return c.ec(t),c.Tb(2).maxPrice=e}),c.Jb(),c.jc(6," \xa0 Filter by category: "),c.Kb(7,"select",7),c.Rb("ngModelChange",function(e){return c.ec(t),c.Tb(2).selectedCategory=e}),c.Kb(8,"option",8),c.jc(9,"ALL CATEGORIES"),c.Jb(),c.hc(10,_,3,4,"option",9),c.Jb(),c.Jb(),c.hc(11,F,23,15,"div",10),c.Ub(12,"filterByMaxprice"),c.Ub(13,"filterByCategory"),c.Jb()}if(2&t){const t=c.Tb(2);c.xb(5),c.Xb("ngModel",t.maxPrice),c.xb(2),c.Xb("ngModel",t.selectedCategory),c.xb(1),c.Xb("ngValue",null),c.xb(2),c.Xb("ngForOf",t.categoriesList),c.xb(1),c.Xb("ngForOf",c.Wb(12,5,c.Wb(13,8,t.coupons,t.selectedCategory),t.maxPrice))}}function T(t,e){if(1&t&&(c.Kb(0,"div"),c.hc(1,E,14,11,"div",2),c.Jb()),2&t){const t=c.Tb(),e=c.dc(7);c.xb(1),c.Xb("ngIf",t.coupons.length)("ngIfElse",e)}}function V(t,e){1&t&&(c.Kb(0,"p",18),c.jc(1,"Loading coupons..."),c.Jb())}function B(t,e){1&t&&(c.Kb(0,"h3"),c.jc(1,"No coupons awailable for purchase"),c.Jb())}const H=function(){return["/customer/home"]};let U=(()=>{class t{constructor(t,e){this.couponsService=t,this.alertService=e,this.loading=!1,this.purchasing=!1,this.coupons=[],this.maxPrice=0,this.selectedCategory=null,this.categoriesList=[]}ngOnInit(){this.loadCoupons()}ngOnDestroy(){this.cSub&&this.cSub.unsubscribe()}loadCoupons(){this.loading=!0,this.cSub=this.couponsService.getAwailableCoupons(+localStorage.getItem("id")).subscribe(t=>{this.coupons=t,this.loading=!1},t=>{this.alertService.danger(t.error.message)}),this.couponsService.getCategoriesForCustomer().subscribe(t=>{this.categoriesObj=t,this.categoriesList=this.categoriesObj.categories},t=>{this.alertService.danger(t.error.message)})}purchase(t){this.purchasing=!0,this.couponsService.purchaseCoupon(t).subscribe(t=>{this.alertService.success("Coupon purchased"),this.loadCoupons(),this.purchasing=!1},t=>{this.alertService.danger(t.error.message)})}}return t.\u0275fac=function(e){return new(e||t)(c.Hb(d.a),c.Hb(m.a))},t.\u0275cmp=c.Bb({type:t,selectors:[["app-coupon-purchase"]],decls:8,vars:4,consts:[[3,"routerLink"],[1,"btn","btn-dark"],[4,"ngIf","ngIfElse"],["loadingBlock",""],["noElements",""],[1,"filter"],["type","number","min","0","max","99999",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange"],["selected","selected",3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["class","card",4,"ngFor","ngForOf"],[3,"ngValue"],[1,"card"],["alt","coupon image",3,"src",4,"ngIf"],[1,"data"],[1,"title"],[1,"btn","btn-dark",3,"disabled","click"],["alt","coupon image",3,"src"],[1,"text-center"]],template:function(t,e){if(1&t&&(c.Kb(0,"a",0),c.Kb(1,"button",1),c.jc(2,"Back"),c.Jb(),c.Jb(),c.hc(3,T,2,2,"div",2),c.hc(4,V,2,0,"ng-template",null,3,c.ic),c.hc(6,B,2,0,"ng-template",null,4,c.ic)),2&t){const t=c.dc(5);c.Xb("routerLink",c.Zb(3,H)),c.xb(3),c.Xb("ngIf",!e.loading)("ngIfElse",t)}},directives:[r.e,b.m,f.k,f.a,f.g,f.i,f.m,f.j,f.o,b.l],pipes:[x.a,C.a,b.j,b.e],styles:["img[_ngcontent-%COMP%]{max-height:120px;max-width:120px;margin-right:20px;position:relative}.title[_ngcontent-%COMP%]{color:#00f}.card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{float:right}.card[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{display:inline-block}span[_ngcontent-%COMP%]{font-size:1.2rem}input[_ngcontent-%COMP%]{margin-top:10px}input[type=number][_ngcontent-%COMP%]{width:70px}select[_ngcontent-%COMP%]{width:243px}.filter[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{display:inline-block;margin-top:15px}.data[_ngcontent-%COMP%]{word-wrap:break-word;width:450px}"]}),t})();const A=function(){return["/customer/coupons"]},D=function(){return["/customer/purchase"]};let R=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=c.Bb({type:t,selectors:[["app-customer-home"]],decls:13,vars:4,consts:[[1,"container"],[1,"container","card"],[3,"routerLink"],[1,"btn","btn-dark"]],template:function(t,e){1&t&&(c.Kb(0,"div",0),c.Kb(1,"h2"),c.jc(2,"Customer dashboard"),c.Jb(),c.Jb(),c.Kb(3,"div",1),c.Kb(4,"a",2),c.Kb(5,"button",3),c.jc(6,"My Coupons"),c.Jb(),c.Jb(),c.Kb(7,"a",2),c.Kb(8,"button",3),c.jc(9,"Purchase new coupon"),c.Jb(),c.Jb(),c.Jb(),c.Kb(10,"div",1),c.Kb(11,"h3"),c.jc(12,"... additional info might be here ..."),c.Jb(),c.Jb()),2&t&&(c.xb(4),c.Xb("routerLink",c.Zb(2,A)),c.xb(3),c.Xb("routerLink",c.Zb(3,D)))},directives:[r.e],styles:[".container[_ngcontent-%COMP%]{max-width:600px;align-items:center;margin-left:auto;margin-right:auto;margin-top:3rem;padding:2rem}button[_ngcontent-%COMP%]{font-size:1.5rem}"]}),t})(),Z=(()=>{class t{}return t.\u0275mod=c.Fb({type:t}),t.\u0275inj=c.Eb({factory:function(e){return new(e||t)},providers:[s],imports:[[b.c,a.a,r.f.forChild([{path:"",component:h,children:[{path:"",redirectTo:"/",pathMatch:"full"},{path:"home",component:R,canActivate:[s]},{path:"coupons",component:k,canActivate:[s]},{path:"coupons/data/:id",component:L,canActivate:[s]},{path:"purchase",component:U,canActivate:[s]}]}])],r.f]}),t})()}}]);