(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{M4UK:function(t,e,n){"use strict";n.r(e),n.d(e,"CompanyModule",function(){return jt});var o=n("N2Tv"),i=n("fXoL"),r=n("IYfF"),a=n("tyNb");let c=(()=>{class t{constructor(t,e){this.authService=t,this.router=e}canActivate(t,e){if(this.authService.getClientRole()==o.a.COMPANY)return!0;this.authService.logout(),this.router.navigate(["/"],{queryParams:{authStatus:!1},queryParamsHandling:"merge",skipLocationChange:!0})}}return t.\u0275fac=function(e){return new(e||t)(i.Ob(r.a),i.Ob(a.c))},t.\u0275prov=i.Db({token:t,factory:t.\u0275fac}),t})();var b=n("PCNd"),s=n("ijts"),u=n("FYjP");const l=function(){return["/company","home"]},d=function(){return["/company","coupons"]},m=function(){return["/company","new"]};let g=(()=>{class t{constructor(t,e,n){this.router=t,this.authService=e,this.companiesService=n}ngOnInit(){this.name=sessionStorage.getItem("name")}logout(t){t.preventDefault(),this.authService.logout(),this.router.navigate(["/"])}}return t.\u0275fac=function(e){return new(e||t)(i.Hb(a.c),i.Hb(r.a),i.Hb(s.a))},t.\u0275cmp=i.Bb({type:t,selectors:[["app-company-layout"]],decls:19,vars:7,consts:[[1,"navbar","bg-primary"],["routerLinkActive","active"],[3,"routerLink"],["href","#",3,"click"],[1,"container"]],template:function(t,e){1&t&&(i.Kb(0,"nav",0),i.Kb(1,"h1"),i.jc(2),i.Jb(),i.Kb(3,"ul"),i.Kb(4,"li",1),i.Kb(5,"a",2),i.jc(6,"Home"),i.Jb(),i.Jb(),i.Kb(7,"li",1),i.Kb(8,"a",2),i.jc(9,"Coupons"),i.Jb(),i.Jb(),i.Kb(10,"li",1),i.Kb(11,"a",2),i.jc(12,"Create new coupon"),i.Jb(),i.Jb(),i.Kb(13,"li"),i.Kb(14,"a",3),i.Rb("click",function(t){return e.logout(t)}),i.jc(15,"Logout"),i.Jb(),i.Jb(),i.Jb(),i.Jb(),i.Kb(16,"div",4),i.Ib(17,"app-alert"),i.Ib(18,"router-outlet"),i.Jb()),2&t&&(i.xb(2),i.lc("Welcome ",e.name,""),i.xb(3),i.Xb("routerLink",i.Zb(4,l)),i.xb(3),i.Xb("routerLink",i.Zb(5,d)),i.xb(3),i.Xb("routerLink",i.Zb(6,m)))},directives:[a.d,a.e,u.a,a.g],styles:[".container[_ngcontent-%COMP%]{max-width:700px}"]}),t})();var p=n("ofXK"),f=n("uQub"),h=n("Cmua"),v=n("3Pt+"),x=n("cHH+"),J=n("CtUz");function K(t,e){if(1&t&&(i.Kb(0,"option",11),i.jc(1),i.Ub(2,"lowercase"),i.Jb()),2&t){const t=e.$implicit;i.Xb("ngValue",t),i.xb(1),i.kc(i.Vb(2,2,t))}}function y(t,e){if(1&t&&i.Ib(0,"img",15),2&t){const t=i.Tb().$implicit;i.Xb("src",t.image,i.fc)}}const D=function(t){return["/company/coupons/data",t]};function j(t,e){if(1&t&&(i.Kb(0,"div",12),i.hc(1,y,1,1,"img",13),i.Kb(2,"div",14),i.Kb(3,"h4"),i.jc(4),i.Jb(),i.Jb(),i.Kb(5,"a",0),i.Kb(6,"button",1),i.jc(7,"Details"),i.Jb(),i.Jb(),i.Jb()),2&t){const t=e.$implicit;i.xb(1),i.Xb("ngIf",t.image),i.xb(3),i.lc("",t.title," "),i.xb(1),i.Xb("routerLink",i.ac(3,D,t.id))}}function C(t,e){if(1&t){const t=i.Lb();i.Kb(0,"div"),i.Kb(1,"div",5),i.jc(2," Filter by maximum price: "),i.Kb(3,"input",6),i.Rb("ngModelChange",function(e){return i.ec(t),i.Tb(2).maxPrice=e}),i.Jb(),i.jc(4," \xa0 Filter by category: "),i.Kb(5,"select",7),i.Rb("ngModelChange",function(e){return i.ec(t),i.Tb(2).selectedCategory=e}),i.Kb(6,"option",8),i.jc(7,"ALL CATEGORIES"),i.Jb(),i.hc(8,K,3,4,"option",9),i.Jb(),i.Jb(),i.hc(9,j,8,5,"div",10),i.Ub(10,"filterByMaxprice"),i.Ub(11,"filterByCategory"),i.Jb()}if(2&t){const t=i.Tb(2);i.xb(3),i.Xb("ngModel",t.maxPrice),i.xb(2),i.Xb("ngModel",t.selectedCategory),i.xb(1),i.Xb("ngValue",null),i.xb(2),i.Xb("ngForOf",t.categoriesList),i.xb(1),i.Xb("ngForOf",i.Wb(10,5,i.Wb(11,8,t.coupons,t.selectedCategory),t.maxPrice))}}function I(t,e){if(1&t&&(i.Kb(0,"div"),i.hc(1,C,12,11,"div",2),i.Jb()),2&t){const t=i.Tb(),e=i.dc(7);i.xb(1),i.Xb("ngIf",t.coupons.length)("ngIfElse",e)}}function w(t,e){1&t&&(i.Kb(0,"p",16),i.jc(1,"Loading coupons..."),i.Jb())}function T(t,e){1&t&&(i.Kb(0,"p"),i.jc(1,"No coupons registered"),i.Jb())}const X=function(){return["/company/new"]};let S=(()=>{class t{constructor(t,e){this.couponsService=t,this.alertService=e,this.loading=!1,this.categoriesList=[],this.coupons=[],this.maxPrice=0,this.selectedCategory=null}ngOnInit(){this.loading=!0,this.cSub=this.couponsService.getCompanyCoupons().subscribe(t=>{this.coupons=t,this.loading=!1},t=>{this.alertService.danger(t.error.message)}),this.couponsService.getCategoriesForCompany().subscribe(t=>{this.categoriesObj=t,this.categoriesList=this.categoriesObj.categories},t=>{this.alertService.danger(t.error.message)})}ngOnDestroy(){this.cSub&&this.cSub.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(i.Hb(f.a),i.Hb(h.a))},t.\u0275cmp=i.Bb({type:t,selectors:[["app-coupons"]],decls:8,vars:4,consts:[[3,"routerLink"],[1,"btn","btn-dark"],[4,"ngIf","ngIfElse"],["loadingBlock",""],["noElements",""],[1,"filter"],["type","number","min","0","max","99999",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange"],["selected","selected",3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["class","card",4,"ngFor","ngForOf"],[3,"ngValue"],[1,"card"],["alt","coupon image",3,"src",4,"ngIf"],[1,"title"],["alt","coupon image",3,"src"],[1,"text-center"]],template:function(t,e){if(1&t&&(i.Kb(0,"a",0),i.Kb(1,"button",1),i.jc(2,"Add new coupon"),i.Jb(),i.Jb(),i.hc(3,I,2,2,"div",2),i.hc(4,w,2,0,"ng-template",null,3,i.ic),i.hc(6,T,2,0,"ng-template",null,4,i.ic)),2&t){const t=i.dc(5);i.Xb("routerLink",i.Zb(3,X)),i.xb(3),i.Xb("ngIf",!e.loading)("ngIfElse",t)}},directives:[a.e,p.m,v.k,v.a,v.g,v.i,v.m,v.j,v.o,p.l],pipes:[x.a,J.a,p.j],styles:["img[_ngcontent-%COMP%]{max-height:100px;max-width:100px;margin-right:20px}.card[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{float:right}.card[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{display:inline-block}span[_ngcontent-%COMP%]{font-size:1.4rem}input[_ngcontent-%COMP%]{margin-top:10px}input[type=number][_ngcontent-%COMP%]{width:70px}select[_ngcontent-%COMP%]{width:243px}.filter[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{display:inline-block;margin-top:15px}.title[_ngcontent-%COMP%]{word-wrap:break-word;width:383px}"]}),t})();class M{static expiredDate(t){let e=Object(p.r)(new Date,"yyyy-MM-dd","en_US");return Object(p.r)(t.value,"yyyy-MM-dd","en_US")<e?{datePassed:!0}:null}static stopDateBeforeStartDate(t){return e=>{const n=Object(p.r)(e.value,"yyyy-MM-dd","en_US");return Object(p.r)(t,"yyyy-MM-dd","en_US")>n?{stopDateBeforeStartDate:!0}:null}}}function O(t,e){if(1&t){const t=i.Lb();i.Kb(0,"div"),i.Kb(1,"div",6),i.Ib(2,"img",7),i.Kb(3,"h2"),i.jc(4),i.Jb(),i.Jb(),i.Kb(5,"span"),i.Kb(6,"h3"),i.jc(7),i.Jb(),i.Jb(),i.Kb(8,"span"),i.Kb(9,"h4"),i.jc(10),i.Ub(11,"lowercase"),i.Jb(),i.Jb(),i.Kb(12,"span"),i.Kb(13,"h4"),i.jc(14),i.Jb(),i.Jb(),i.Kb(15,"span"),i.Kb(16,"h4"),i.jc(17),i.Jb(),i.Jb(),i.Kb(18,"span"),i.Kb(19,"h4"),i.jc(20),i.Ub(21,"date"),i.Jb(),i.Jb(),i.Kb(22,"span"),i.Kb(23,"h4"),i.jc(24),i.Ub(25,"date"),i.Jb(),i.Jb(),i.Kb(26,"button",8),i.Rb("click",function(){return i.ec(t),i.Tb(2).setUpdate()}),i.jc(27,"Update"),i.Jb(),i.Kb(28,"button",9),i.Rb("click",function(){return i.ec(t),i.Tb(2).delete()}),i.jc(29,"Delete"),i.Jb(),i.Jb()}if(2&t){const t=i.Tb(2);i.xb(2),i.Xb("src",t.coupon.image,i.fc),i.xb(2),i.kc(t.coupon.title),i.xb(3),i.kc(t.coupon.description),i.xb(3),i.lc("Category: ",i.Vb(11,8,t.coupon.category),""),i.xb(4),i.lc("Quantity: ",t.coupon.amount," items"),i.xb(3),i.lc("Price: ",t.coupon.price," NIS"),i.xb(3),i.lc("Issue date: ",i.Vb(21,10,t.coupon.startDate),""),i.xb(4),i.lc("Expiration date: ",i.Vb(25,12,t.coupon.endDate),"")}}function k(t,e){if(1&t&&(i.Kb(0,"div"),i.hc(1,O,30,14,"div",3),i.Jb()),2&t){const t=i.Tb(),e=i.dc(6);i.xb(1),i.Xb("ngIf",!t.update)("ngIfElse",e)}}function P(t,e){1&t&&(i.Kb(0,"small"),i.jc(1,"Coupon title is required"),i.Jb())}function L(t,e){if(1&t&&(i.Kb(0,"small"),i.jc(1),i.Jb()),2&t){const t=i.Tb(3);i.xb(1),i.mc(" Title should be no more than ",t.form.get("title").errors.maxlength.requiredLength," characters long, now it is ",t.form.get("title").errors.maxlength.actualLength," characters long ")}}function q(t,e){if(1&t&&(i.Kb(0,"div",24),i.hc(1,P,2,0,"small",25),i.hc(2,L,2,2,"small",25),i.Jb()),2&t){const t=i.Tb(2);i.xb(1),i.Xb("ngIf",t.form.get("title").errors.required),i.xb(1),i.Xb("ngIf",t.form.get("title").errors.maxlength)}}function _(t,e){1&t&&(i.Kb(0,"small"),i.jc(1,"Coupon description is required"),i.Jb())}function A(t,e){if(1&t&&(i.Kb(0,"small"),i.jc(1),i.Jb()),2&t){const t=i.Tb(3);i.xb(1),i.mc(" Description should be no more than ",t.form.get("description").errors.maxlength.requiredLength," characters long, now it is ",t.form.get("title").errors.maxlength.actualLength," characters long ")}}function V(t,e){if(1&t&&(i.Kb(0,"div",24),i.hc(1,_,2,0,"small",25),i.hc(2,A,2,2,"small",25),i.Jb()),2&t){const t=i.Tb(2);i.xb(1),i.Xb("ngIf",t.form.get("description").errors.required),i.xb(1),i.Xb("ngIf",t.form.get("description").errors.maxlength)}}function N(t,e){if(1&t&&(i.Kb(0,"option",26),i.jc(1),i.Ub(2,"lowercase"),i.Jb()),2&t){const t=e.$implicit;i.Xb("ngValue",t),i.xb(1),i.kc(i.Vb(2,2,t))}}function E(t,e){1&t&&(i.Kb(0,"div",24),i.Kb(1,"small"),i.jc(2,"Category not chosen"),i.Jb(),i.Jb())}function F(t,e){1&t&&(i.Kb(0,"small"),i.jc(1,"Start date is required"),i.Jb())}function R(t,e){if(1&t&&(i.Kb(0,"div",24),i.hc(1,F,2,0,"small",25),i.Jb()),2&t){const t=i.Tb(2);i.xb(1),i.Xb("ngIf",t.form.get("startDate").errors.required)}}function H(t,e){1&t&&(i.Kb(0,"small"),i.jc(1,"Expiration date is required"),i.Jb())}function U(t,e){1&t&&(i.Kb(0,"small"),i.jc(1,"This date is passed"),i.Jb())}function B(t,e){1&t&&(i.Kb(0,"small"),i.jc(1,"Expiration date before start date not allowed"),i.Jb())}function Z(t,e){if(1&t&&(i.Kb(0,"div",24),i.hc(1,H,2,0,"small",25),i.hc(2,U,2,0,"small",25),i.hc(3,B,2,0,"small",25),i.Jb()),2&t){const t=i.Tb(2);i.xb(1),i.Xb("ngIf",t.form.get("endDate").errors.required),i.xb(1),i.Xb("ngIf",t.form.get("endDate").errors.datePassed),i.xb(1),i.Xb("ngIf",t.form.get("endDate").errors.endDateBeforeStartDate)}}function G(t,e){1&t&&(i.Kb(0,"div",24),i.Kb(1,"small"),i.jc(2,"Amount is required"),i.Jb(),i.Jb())}function W(t,e){1&t&&(i.Kb(0,"div",24),i.Kb(1,"small"),i.jc(2,"Price is required"),i.Jb(),i.Jb())}function $(t,e){if(1&t){const t=i.Lb();i.Kb(0,"form",10),i.Rb("ngSubmit",function(){return i.ec(t),i.Tb().submit()}),i.Ib(1,"img",7),i.Kb(2,"div",11),i.Kb(3,"label"),i.jc(4,"Image url:"),i.Jb(),i.Kb(5,"input",12),i.Rb("blur",function(e){return i.ec(t),i.Tb().preloadImage(e)}),i.Jb(),i.Jb(),i.Kb(6,"div",11),i.Kb(7,"label"),i.jc(8,"Title"),i.Jb(),i.Ib(9,"input",13),i.hc(10,q,3,2,"div",14),i.Jb(),i.Kb(11,"div",11),i.Kb(12,"label"),i.jc(13,"Description"),i.Jb(),i.Ib(14,"input",15),i.hc(15,V,3,2,"div",14),i.Jb(),i.Kb(16,"div",11),i.Kb(17,"label"),i.jc(18,"Category"),i.Jb(),i.Kb(19,"select",16),i.hc(20,N,3,4,"option",17),i.Jb(),i.hc(21,E,3,0,"div",14),i.Jb(),i.Kb(22,"div",11),i.Kb(23,"label"),i.jc(24,"Start date"),i.Jb(),i.Kb(25,"input",18),i.Rb("focus",function(){return i.ec(t),i.Tb().setAttributeToDate1=!0})("blur",function(){return i.ec(t),i.Tb().setAttributeToDate1=!1})("input",function(e){return i.ec(t),i.Tb().onInputDate1(e)}),i.Jb(),i.hc(26,R,2,1,"div",14),i.Jb(),i.Kb(27,"div",11),i.Kb(28,"label"),i.jc(29,"Expiration date"),i.Jb(),i.Kb(30,"input",19),i.Rb("focus",function(){return i.ec(t),i.Tb().setAttributeToDate2=!0})("blur",function(){return i.ec(t),i.Tb().setAttributeToDate2=!1})("input",function(e){return i.ec(t),i.Tb().onInputDate2(e)}),i.Jb(),i.hc(31,Z,4,3,"div",14),i.Jb(),i.Kb(32,"div",11),i.Kb(33,"label"),i.jc(34,"Amount"),i.Jb(),i.Ib(35,"input",20),i.hc(36,G,3,0,"div",14),i.Jb(),i.Kb(37,"div",11),i.Kb(38,"label"),i.jc(39,"Price"),i.Jb(),i.Ib(40,"input",21),i.hc(41,W,3,0,"div",14),i.Jb(),i.Kb(42,"button",22),i.jc(43,"Save"),i.Jb(),i.Kb(44,"button",23),i.Rb("click",function(){return i.ec(t),i.Tb().update=!1}),i.jc(45,"Cancel"),i.Jb(),i.Jb()}if(2&t){const t=i.Tb();i.Xb("formGroup",t.form),i.xb(1),i.Xb("src",t.image,i.fc),i.xb(4),i.Xb("value",t.image),i.xb(5),i.Xb("ngIf",t.form.get("title").invalid&&t.form.get("title").touched),i.xb(5),i.Xb("ngIf",t.form.get("description").invalid&&t.form.get("description").touched),i.xb(5),i.Xb("ngForOf",t.categoriesList),i.xb(1),i.Xb("ngIf",t.form.get("category").invalid&&t.form.get("category").touched),i.xb(4),i.Xb("type",t.setAttributeToDate1?"date":"text"),i.xb(1),i.Xb("ngIf",t.form.get("startDate").invalid&&t.form.get("startDate").touched),i.xb(4),i.Xb("type",t.setAttributeToDate2?"date":"text"),i.xb(1),i.Xb("ngIf",t.form.get("endDate").invalid&&t.form.get("endDate").touched),i.xb(5),i.Xb("ngIf",t.form.get("amount").invalid&&t.form.get("amount").touched),i.xb(5),i.Xb("ngIf",t.form.get("price").invalid&&t.form.get("price").touched),i.xb(1),i.Xb("disabled",t.form.invalid||t.form.submitting)}}function z(t,e){1&t&&(i.Kb(0,"p",27),i.jc(1,"Loading..."),i.Jb())}const Y=function(){return["/company/coupons"]};let Q=(()=>{class t{constructor(t,e,n,o,i,r){this.route=t,this.router=e,this.couponsService=n,this.companiesService=o,this.datePipe=i,this.alertService=r,this.categoriesList=[],this.loading=!1,this.update=!1,this.submitting=!1,this.startDateValue=new Date(Date.now()),this.endDateValue=new Date(Date.now()),this.image=""}ngOnInit(){this.loadCoupon()}ngOnDestroy(){this.dSub&&this.dSub.unsubscribe()}delete(){this.dSub=this.couponsService.delete(this.coupon.id).subscribe(()=>{this.alertService.success("Coupon deleted"),this.router.navigate(["/company/coupons"])},t=>{this.alertService.danger(t.error.message)})}loadCoupon(){this.loading=!0,this.couponsService.getCategoriesForCompany().subscribe(t=>{this.categoriesObj=t,this.categoriesList=this.categoriesObj.categories},t=>{this.alertService.danger(t.error.message)}),this.companiesService.getCompanyDetails(+localStorage.getItem("id")).subscribe(t=>{this.company=t},t=>{this.alertService.danger(t.error.message)}),this.route.params.subscribe(t=>{this.couponsService.getCompanyCouponById(t.id).subscribe(t=>{this.coupon=t,null!=this.coupon&&(this.image=this.coupon.image,this.loading=!1)},t=>{this.alertService.danger(t.error.message)})})}submit(){if(this.form.invalid)return;this.submitting=!0;const t={id:this.coupon.id,company:this.company,category:this.form.value.category,title:this.form.value.title,description:this.form.value.description,startDate:this.form.value.startDate,endDate:this.form.value.endDate,amount:this.form.value.amount,price:this.form.value.price,image:this.form.value.image};t.image||(t.image="assets/images/coupon-icon.png"),this.couponsService.update(t).subscribe(()=>{this.update=!1,this.submitting=!1,this.alertService.success("Coupon updated"),this.loadCoupon()},t=>{this.alertService.danger(t.error.message)})}setUpdate(){this.update=!0,this.form=new v.d({category:new v.b(this.coupon.category,[v.n.required]),title:new v.b(this.coupon.title,[v.n.required,v.n.maxLength(255)]),description:new v.b(this.coupon.description,[v.n.required,v.n.maxLength(4e3)]),startDate:new v.b(this.datePipe.transform(this.coupon.startDate,"yyyy-MM-dd"),[v.n.required]),endDate:new v.b(this.datePipe.transform(this.coupon.endDate,"yyyy-MM-dd"),[v.n.required,M.expiredDate]),amount:new v.b(this.coupon.amount,[v.n.required]),price:new v.b(this.coupon.price,[v.n.required]),image:new v.b(this.image)})}onInputDate1(t){this.startDateValue=t.target.value,this.compareDates()}onInputDate2(t){this.endDateValue=t.target.value,this.compareDates()}compareDates(){this.endDateValue<this.startDateValue&&(console.log("invalid dates!!!"),this.form.controls.endDate.setErrors({endDateBeforeStartDate:!0}))}preloadImage(t){this.image=t.target.value}}return t.\u0275fac=function(e){return new(e||t)(i.Hb(a.a),i.Hb(a.c),i.Hb(f.a),i.Hb(s.a),i.Hb(p.e),i.Hb(h.a))},t.\u0275cmp=i.Bb({type:t,selectors:[["app-coupon-details"]],inputs:{company:"company"},decls:9,vars:4,consts:[[3,"routerLink"],[1,"btn","btn-dark"],[1,"card"],[4,"ngIf","ngIfElse"],["updateCoupon",""],["loadingBlock",""],[1,"card","header"],[3,"src"],[1,"btn","btn-dark",3,"click"],[1,"btn","btn-primary",3,"click"],[3,"formGroup","ngSubmit"],[1,"form-control"],["type","text","formControlName","image",3,"value","blur"],["type","text","formControlName","title"],["class","validation",4,"ngIf"],["type","text","formControlName","description"],["formControlName","category"],[3,"ngValue",4,"ngFor","ngForOf"],["formControlName","startDate",3,"type","focus","blur","input"],["formControlName","endDate",3,"type","focus","blur","input"],["type","number","min","1","max","999","formControlName","amount"],["type","number","min","0","max","99999","formControlName","price"],["type","submit",1,"btn","btn-primary",3,"disabled"],["type","button",1,"btn","btn-dark",3,"click"],[1,"validation"],[4,"ngIf"],[3,"ngValue"],[1,"text-center"]],template:function(t,e){if(1&t&&(i.Kb(0,"a",0),i.Kb(1,"button",1),i.jc(2,"Back"),i.Jb(),i.Jb(),i.Kb(3,"div",2),i.hc(4,k,2,2,"div",3),i.Jb(),i.hc(5,$,46,14,"ng-template",null,4,i.ic),i.hc(7,z,2,0,"ng-template",null,5,i.ic)),2&t){const t=i.dc(8);i.Xb("routerLink",i.Zb(3,Y)),i.xb(4),i.Xb("ngIf",!e.loading)("ngIfElse",t)}},directives:[a.e,p.m,v.p,v.h,v.e,v.a,v.g,v.c,v.m,p.l,v.k,v.j,v.o],pipes:[p.j,p.e],styles:["img[_ngcontent-%COMP%]{max-height:100px;max-width:100px;margin-right:20px}span[_ngcontent-%COMP%]{margin:5px}button[_ngcontent-%COMP%], label[_ngcontent-%COMP%]{margin-top:10px}label[_ngcontent-%COMP%]{color:#000;font-family:Roboto,sans-serif;font-size:1.2rem;font-weight:700;line-height:1.6;background-color:#fff;color:#333}input[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:10px}"]}),t})();function tt(t,e){if(1&t&&(i.Kb(0,"option",20),i.jc(1),i.Ub(2,"lowercase"),i.Jb()),2&t){const t=e.$implicit;i.Yb("value",t),i.xb(1),i.kc(i.Vb(2,2,t))}}function et(t,e){1&t&&(i.Kb(0,"div",21),i.Kb(1,"small"),i.jc(2,"Category not chosen"),i.Jb(),i.Jb())}function nt(t,e){1&t&&(i.Kb(0,"small"),i.jc(1,"Title is required"),i.Jb())}function ot(t,e){if(1&t&&(i.Kb(0,"small"),i.jc(1),i.Jb()),2&t){const t=i.Tb(3);i.xb(1),i.mc(" Title should be no more than ",t.form.get("title").errors.maxlength.requiredLength," characters long, now it is ",t.form.get("title").errors.maxlength.actualLength," characters long ")}}function it(t,e){if(1&t&&(i.Kb(0,"div",21),i.hc(1,nt,2,0,"small",22),i.hc(2,ot,2,2,"small",22),i.Jb()),2&t){const t=i.Tb(2);i.xb(1),i.Xb("ngIf",t.form.get("title").errors.required),i.xb(1),i.Xb("ngIf",t.form.get("title").errors.maxlength)}}function rt(t,e){1&t&&(i.Kb(0,"small"),i.jc(1,"Description is required"),i.Jb())}function at(t,e){if(1&t&&(i.Kb(0,"small"),i.jc(1),i.Jb()),2&t){const t=i.Tb(3);i.xb(1),i.mc(" Description should be no more than ",t.form.get("description").errors.maxlength.requiredLength," characters long, now it is ",t.form.get("title").errors.maxlength.actualLength," characters long ")}}function ct(t,e){if(1&t&&(i.Kb(0,"div",21),i.hc(1,rt,2,0,"small",22),i.hc(2,at,2,2,"small",22),i.Jb()),2&t){const t=i.Tb(2);i.xb(1),i.Xb("ngIf",t.form.get("description").errors.required),i.xb(1),i.Xb("ngIf",t.form.get("description").errors.maxlength)}}function bt(t,e){1&t&&(i.Kb(0,"small"),i.jc(1,"Start date is required "),i.Jb())}function st(t,e){1&t&&(i.Kb(0,"small"),i.jc(1,"This date is passed"),i.Jb())}function ut(t,e){if(1&t&&(i.Kb(0,"div",21),i.hc(1,bt,2,0,"small",22),i.hc(2,st,2,0,"small",22),i.Jb()),2&t){const t=i.Tb(2);i.xb(1),i.Xb("ngIf",t.form.get("startDate").errors.required),i.xb(1),i.Xb("ngIf",t.form.get("startDate").errors.datePassed)}}function lt(t,e){1&t&&(i.Kb(0,"small"),i.jc(1,"Expiration date is required "),i.Jb())}function dt(t,e){1&t&&(i.Kb(0,"small"),i.jc(1,"This date is passed"),i.Jb())}function mt(t,e){1&t&&(i.Kb(0,"small"),i.jc(1,"Expiration date before start date not allowed"),i.Jb())}function gt(t,e){if(1&t&&(i.Kb(0,"div",21),i.hc(1,lt,2,0,"small",22),i.hc(2,dt,2,0,"small",22),i.hc(3,mt,2,0,"small",22),i.Jb()),2&t){const t=i.Tb(2);i.xb(1),i.Xb("ngIf",t.form.get("endDate").errors.required),i.xb(1),i.Xb("ngIf",t.form.get("endDate").errors.datePassed),i.xb(1),i.Xb("ngIf",t.form.get("endDate").errors.endDateBeforeStartDate)}}function pt(t,e){1&t&&(i.Kb(0,"div",21),i.Kb(1,"small"),i.jc(2,"Amount is required"),i.Jb(),i.Jb())}function ft(t,e){1&t&&(i.Kb(0,"div",21),i.Kb(1,"small"),i.jc(2,"Price is required"),i.Jb(),i.Jb())}const ht=function(){return["/company/home"]};function vt(t,e){if(1&t){const t=i.Lb();i.Kb(0,"div"),i.Kb(1,"a",3),i.Kb(2,"button",4),i.jc(3,"Cancel"),i.Jb(),i.Jb(),i.Kb(4,"form",5),i.Rb("ngSubmit",function(){return i.ec(t),i.Tb().submit()}),i.Kb(5,"h2"),i.jc(6,"Create new coupon"),i.Jb(),i.Kb(7,"div",6),i.Kb(8,"label"),i.jc(9,"Category"),i.Jb(),i.Kb(10,"select",7),i.Kb(11,"option",8),i.jc(12,"--Please choose category--"),i.Jb(),i.hc(13,tt,3,4,"option",9),i.Jb(),i.hc(14,et,3,0,"div",10),i.Jb(),i.Kb(15,"div",6),i.Kb(16,"label"),i.jc(17,"Title"),i.Jb(),i.Ib(18,"input",11),i.hc(19,it,3,2,"div",10),i.Jb(),i.Kb(20,"div",6),i.Kb(21,"label"),i.jc(22,"Description"),i.Jb(),i.Ib(23,"input",12),i.hc(24,ct,3,2,"div",10),i.Jb(),i.Kb(25,"div",6),i.Kb(26,"label"),i.jc(27,"Start date"),i.Jb(),i.Kb(28,"input",13),i.Rb("focus",function(){return i.ec(t),i.Tb().setAttributeToDate1=!0})("blur",function(){return i.ec(t),i.Tb().setAttributeToDate1=!1})("input",function(e){return i.ec(t),i.Tb().onInputDate1(e)}),i.Ub(29,"date"),i.Jb(),i.hc(30,ut,3,2,"div",10),i.Jb(),i.Kb(31,"div",6),i.Kb(32,"label"),i.jc(33,"Expiration date"),i.Jb(),i.Kb(34,"input",14),i.Rb("focus",function(){return i.ec(t),i.Tb().setAttributeToDate2=!0})("blur",function(){return i.ec(t),i.Tb().setAttributeToDate2=!1})("input",function(e){return i.ec(t),i.Tb().onInputDate2(e)}),i.Ub(35,"date"),i.Jb(),i.hc(36,gt,4,3,"div",10),i.Jb(),i.Kb(37,"div",6),i.Kb(38,"label"),i.jc(39,"Amount"),i.Jb(),i.Ib(40,"input",15),i.hc(41,pt,3,0,"div",10),i.Jb(),i.Kb(42,"div",6),i.Kb(43,"label"),i.jc(44,"Price"),i.Jb(),i.Ib(45,"input",16),i.hc(46,ft,3,0,"div",10),i.Jb(),i.Kb(47,"div",6),i.Kb(48,"label"),i.jc(49,"Image url"),i.Jb(),i.Ib(50,"input",17),i.Jb(),i.Kb(51,"button",18),i.jc(52,"Add new coupon"),i.Jb(),i.Kb(53,"button",19),i.Rb("click",function(){return i.ec(t),i.Tb().formReset()}),i.jc(54,"Reset all fields"),i.Jb(),i.Jb(),i.Jb()}if(2&t){const t=i.Tb();i.xb(1),i.Xb("routerLink",i.Zb(21,ht)),i.xb(3),i.Xb("formGroup",t.form),i.xb(9),i.Xb("ngForOf",t.categoriesList),i.xb(1),i.Xb("ngIf",t.form.get("category").invalid&&t.form.get("category").touched),i.xb(5),i.Xb("ngIf",t.form.get("title").invalid&&t.form.get("title").touched),i.xb(5),i.Xb("ngIf",t.form.get("description").invalid&&t.form.get("description").touched),i.xb(4),i.Xb("type",t.setAttributeToDate1?"date":"text")("placeholder",i.Wb(29,15,t.dateToday,"yyyy-MM-dd")),i.xb(2),i.Xb("ngIf",t.form.get("startDate").invalid&&t.form.get("startDate").touched),i.xb(4),i.Xb("type",t.setAttributeToDate2?"date":"text")("placeholder",i.Wb(35,18,t.dateToday,"yyyy-MM-dd")),i.xb(2),i.Xb("ngIf",t.form.get("endDate").invalid&&t.form.get("endDate").touched),i.xb(5),i.Xb("ngIf",t.form.get("amount").invalid&&t.form.get("amount").touched),i.xb(5),i.Xb("ngIf",t.form.get("price").invalid&&t.form.get("price").touched),i.xb(5),i.Xb("disabled",t.form.invalid)}}function xt(t,e){1&t&&(i.Kb(0,"p",23),i.jc(1,"Loading form..."),i.Jb())}let Jt=(()=>{class t{constructor(t,e,n,o){this.couponsService=t,this.companiesService=e,this.router=n,this.alertService=o,this.loading=!1,this.categoriesList=[],this.dateToday=new Date(Date.now()),this.startDateValue=new Date(Date.now()),this.endDateValue=new Date(Date.now()),this.setAttributeToDate1=!1,this.setAttributeToDate2=!1}ngOnInit(){this.loading=!0,this.couponsService.getCategoriesForCompany().subscribe(t=>{this.categoriesObj=t,this.categoriesList=this.categoriesObj.categories}),this.companiesService.getCompanyDetails(+localStorage.getItem("id")).subscribe(t=>{this.company=t,this.loading=!1}),this.form=new v.d({category:new v.b("",[v.n.required]),title:new v.b("",[v.n.required,v.n.maxLength(255)]),description:new v.b("",[v.n.required,v.n.maxLength(4e3)]),startDate:new v.b(this.dateToday,[v.n.required,M.expiredDate]),endDate:new v.b(this.dateToday,[v.n.required,M.expiredDate]),amount:new v.b(1,[v.n.required]),price:new v.b("",[v.n.required]),image:new v.b("")})}submit(){const t={company:this.company,category:this.form.value.category,title:this.form.value.title,description:this.form.value.description,startDate:this.form.value.startDate,endDate:this.form.value.endDate,amount:this.form.value.amount,price:this.form.value.price,image:this.form.value.image};t.image||(t.image="assets/images/coupon-icon.png"),this.couponsService.add(t).subscribe(()=>{this.alertService.success("Coupon added"),this.router.navigate(["/company/coupons"])},t=>{this.alertService.danger(t.error.message)})}onInputDate1(t){this.startDateValue=t.target.value,this.compareDates()}onInputDate2(t){this.endDateValue=t.target.value,this.compareDates()}compareDates(){this.endDateValue<this.startDateValue&&(console.log("invalid dates!!!"),this.form.controls.endDate.setErrors({endDateBeforeStartDate:!0}))}formReset(){this.form.reset()}}return t.\u0275fac=function(e){return new(e||t)(i.Hb(f.a),i.Hb(s.a),i.Hb(a.c),i.Hb(h.a))},t.\u0275cmp=i.Bb({type:t,selectors:[["app-coupon-add"]],decls:4,vars:2,consts:[[1,"container"],[4,"ngIf","ngIfElse"],["loadingBlock",""],[3,"routerLink"],[1,"btn","btn-dark"],[1,"card",3,"formGroup","ngSubmit"],[1,"form-control"],["formControlName","category"],["value","","selected","selected"],[3,"value",4,"ngFor","ngForOf"],["class","validation",4,"ngIf"],["type","text","placeholder","Title","formControlName","title"],["type","text","placeholder","Description","formControlName","description"],["formControlName","startDate",3,"type","placeholder","focus","blur","input"],["formControlName","endDate",3,"type","placeholder","focus","blur","input"],["type","number","min","1","max","999","formControlName","amount"],["type","number","min","0","max","99999","formControlName","price"],["type","text","placeholder","image url (optional)","formControlName","image"],["type","submit",1,"btn","btn-primary",3,"disabled"],["type","button",1,"btn","btn-dark",3,"click"],[3,"value"],[1,"validation"],[4,"ngIf"],[1,"text-center"]],template:function(t,e){if(1&t&&(i.Kb(0,"div",0),i.hc(1,vt,55,22,"div",1),i.hc(2,xt,2,0,"ng-template",null,2,i.ic),i.Jb()),2&t){const t=i.dc(3);i.xb(1),i.Xb("ngIf",!e.loading)("ngIfElse",t)}},directives:[p.m,a.e,v.p,v.h,v.e,v.m,v.g,v.c,v.j,v.o,p.l,v.a,v.k],pipes:[p.e,p.j],styles:["input.ng-invalid.ng-touched[_ngcontent-%COMP%]{border:1px solid red}input.ng-valid.ng-touched[_ngcontent-%COMP%]{border:1px solid green}select.ng-invalid.ng-touched[_ngcontent-%COMP%]{border:1px solid red}select.ng-valid.ng-touched[_ngcontent-%COMP%]{border:1px solid green}.container[_ngcontent-%COMP%]{max-width:600px;margin:0 auto}"]}),t})();const Kt=function(){return["/company/coupons"]},yt=function(){return["/company/new"]};let Dt=(()=>{class t{constructor(){}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=i.Bb({type:t,selectors:[["app-company-home"]],decls:13,vars:4,consts:[[1,"container"],[1,"container","card"],[3,"routerLink"],[1,"btn","btn-dark"]],template:function(t,e){1&t&&(i.Kb(0,"div",0),i.Kb(1,"h2"),i.jc(2,"Company dashboard"),i.Jb(),i.Jb(),i.Kb(3,"div",1),i.Kb(4,"a",2),i.Kb(5,"button",3),i.jc(6,"Coupons"),i.Jb(),i.Jb(),i.Kb(7,"a",2),i.Kb(8,"button",3),i.jc(9,"Create new coupon"),i.Jb(),i.Jb(),i.Jb(),i.Kb(10,"div",1),i.Kb(11,"h3"),i.jc(12,"... additional info might be here ..."),i.Jb(),i.Jb()),2&t&&(i.xb(4),i.Xb("routerLink",i.Zb(2,Kt)),i.xb(3),i.Xb("routerLink",i.Zb(3,yt)))},directives:[a.e],styles:[".container[_ngcontent-%COMP%]{max-width:600px;align-items:center;margin-left:auto;margin-right:auto;margin-top:3rem;padding:2rem}button[_ngcontent-%COMP%]{font-size:1.5rem}"]}),t})(),jt=(()=>{class t{}return t.\u0275mod=i.Fb({type:t}),t.\u0275inj=i.Eb({factory:function(e){return new(e||t)},providers:[c],imports:[[p.c,b.a,a.f.forChild([{path:"",component:g,children:[{path:"",redirectTo:"/",pathMatch:"full"},{path:"home",component:Dt,canActivate:[c]},{path:"coupons",component:S,canActivate:[c]},{path:"coupons/data/:id",component:Q,canActivate:[c]},{path:"new",component:Jt,canActivate:[c]}]}])],a.f]}),t})()}}]);